$(function(){var _post=$("#post"),_posts=$("article.post"),_is_mobile=parseInt(flotheme.is_mobile);$("a[rel=external]").each(function(){$(this).attr("target","_blank")});$("header nav ul").superfish({hoverClass:"hover",delay:100,autoArrows:!1,dropShadows:!1}).find("a[href=#]").click(function(a){a.preventDefault()});$("#sneak-peek").dxSlider();$.fn.initPosts=function(a){typeof a=="undefined"&&(a=!1);var b={rules:{author:{required:!0},email:{required:!0,email:!0},comment:{required:!0}}},c=function(a){a.preventDefault();var b=$(this),c=b.parents(".post").find("div.comment-form");if(!c.length)return;c.scrollTo("fast").find("input[type=text], textarea").filter(":first").focus()},d=function(a,b){a.preventDefault();var c={fn:$(this),scroll:!1},d=$.extend({comments:!1,hide:!1,add_comment:!1},b);c.post=c.fn.parents(".post");c.more=c.post.find(".more");if(d.comments||d.add_comment){c.scroll=$(".share",c.post);e(c);return}if(c.more.is(":visible")){d.hide==1?c.more.hide():c.more.slideUp(400);c.fn.text("Open post");c.post.removeClass("open-post")}else{typeof a.originalEvent!="undefined"&&(c.scroll=c.post);e(c)}},e=function(a){a.post.siblings(".open-post").find("a.toggle").trigger("click",{hide:!0});var d=a.post.find("span.loading");if(a.more.text()==""){a.post.addClass("post-loading");d.css("visibility","visible");a.more.load(flotheme.ajax_load_url,{action:"flotheme_load_post",id:a.post.attr("id").replace("post-","")},function(){d.remove();a.more.slideDown(400,function(){a.post.addClass("open-post");a.fn.text("Close post");a.scroll&&a.scroll.scrollTo("fast")});a.more.find("div.actions a.leave-comment").click(c);flotheme.ajax_comments&&a.more.find("div.comment-form form").validate(b)})}else a.more.slideDown(400,function(){a.post.addClass("open-post");a.fn.text("Close post");a.scroll&&a.scroll.scrollTo("fast")})};$(this).each(function(){var e=$(this);$("div.preview div.gallery",e).dxSlider();if(!_is_mobile){$("div.actions a.leave-comment",e).click(c);if(flotheme.ajax_posts){$("a.toggle",e).click(d);$(".preview .image",e).click(function(){$(this).parents("div.post").find("a.toggle").trigger("click")})}flotheme.ajax_comments&&(b.submitHandler=function(a){var b=$(a),c=e.find("div.comments"),d=b.find("div.submit"),f=e.find("div.messages");b.ajaxSubmit({beforeSubmit:function(){d.hide()},success:function(){b.clearForm();d.fadeIn();c.find("ol").load(flotheme.ajax_load_url,{id:b.find("input[name=comment_post_ID]").val(),action:"flotheme_load_comments"},function(){f.hide().html("Thank you, kindly.  We love hearing what you have to say!").slideDown("fast");setTimeout(function(){f.slideUp("fast")},1e4)})},error:function(a){var b=a.responseText.match(/<p>([^<]+)<\/p>/)[1];f.hide().html(b).slideDown("fast");d.show()}})});$("div.comment-form form",e).each(function(a,c){$(c).validate(b)})}!a&&flotheme.ajax_open_single&&!_post.length&&_posts.length==1&&e.find("a.toggle").trigger("click")})};_posts.initPosts();var load_more_stopper=!1,_load_more_posts_observer=function(e){e.preventDefault();if(load_more_stopper)return;load_more_stopper=!0;var fn=$(this),load_params_input=$("#load-more-params"),params=load_params_input.val();_posts.filter(".open-post").find("a.toggle").trigger("click");var container=$("<div></div>").addClass("container").hide();$("#posts").append(container);fn.addClass("loading");$.get(flotheme.ajax_load_url,params+"&action=flotheme_load_more_posts",function(data){data=eval("("+data+")");container.html(data.html).slideDown("fast",function(){fn.removeClass("loading");load_more_stopper=!1}).scrollTo("fast");container.find("div.post").initPosts(!0);delete data.html;var string="";$.each(data,function(a,b){string+=a+"="+b+"&"});load_params_input.val(string);data.nextpage==-1&&fn.parent().fadeOut("fast",function(){$(this).remove()})})};flotheme.ajax_posts&&!_is_mobile&&$("#load-more a").click(_load_more_posts_observer);$.fn.initContact=function(){$(this).each(function(){var a=$(this),b=a.find("form"),c=a.find("div.messages");b.validate({submitHandler:function(a){$.post(flotheme.ajax_load_url,b.serialize()+"&action=flotheme_submit_contact",function(a){if(a.error){alert(a.msg);return}b.clearForm();c.hide().text(a.msg).slideDown("fast")},"json")}})})};$("div.page div.contact").initContact();$.fn.initVote=function(){$(this).each(function(){var a=$(this),b=a.prop("id").replace("post-",""),c=a.find(".vote-up a"),d=a.find(".vote-down a"),e=function(e){function h(a,b){var e,f,g,h,i,j;if(a=="1"){e=c;f=d;g="+"+b.results.positive;h="-"+b.results.negative;i="-100px";j="0px"}else if(a=="2"){e=d;f=c;g="-"+b.results.negative;h="+"+b.results.positive;i="-100px";j="38px"}e.find(".thumb").animate({top:i,left:j,opacity:0},400,function(){e.parent().find(".result").text(g);f.find(".thumb").fadeOut(300,function(){f.find(".result").text(h)})})}e.stopPropagation();var f,g=$(this).parent().parent();g.hasClass("vote-up")?f="1":g.hasClass("vote-down")&&(f="2");$.post(flotheme.ajax_load_url,"&post_id="+b+"&value="+f+"&action=flotheme_submit_vote",function(b){if(b.error){alert(b.results);return}h(f,b);a.find(".vote").addClass("voted")},"json")};c.find(".thumb").click(e);d.find(".thumb").click(e)})};$(".post").initVote();$("#slider").flexslider({animation:"slide",controlNav:!1,animationLoop:!0,slideshow:!0,start:function(){var a=$("#slider li img").eq(1);a.click(function(a){$(document).click(function(){$("#insert-promise").slideUp(400,function(){$(this).hide()})});$("#insert-promise").fadeIn();a.stopPropagation()}).css({cursor:"pointer"})}});$(".side-slider").each(function(){$(this).flexslider({animation:"slide",controlNav:!1,animationLoop:!0,slideshow:!1})});$.fn.initPromiseForm=function(){var a=$(this);a.click(function(a){a.stopPropagation()});a.find("input.date").datepicker({beforeShow:function(a,b){$(b).click(function(a){a.stopPropagation()})}});a.find(".ui-datepicker").css({position:"fixed"}).click(function(a){a.stopPropagation()});a.find("#who").autocomplete({source:function(a,b){$.ajax({url:flotheme.ajax_load_url+"?action=flotheme_load_politics",dataType:"jsonp",data:{limit:10,q:a.term},success:function(a){$(".ui-autocomplete").css({position:"fixed"}).click(function(a){a.stopPropagation()});b($.map(a,function(a){return{label:a,value:a}}))}})},minLength:2})};$("#insert-promise").initPromiseForm();$(".xrange .follow").click(function(){alert("Adauga email-ul pentru a urmari promisiunea")});$("#insert-promise .button").click(function(){$("#insert-promise").slideUp(400,function(){$(this).hide()})})});